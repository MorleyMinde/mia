<section class="p-4 sm:p-6 space-y-5">
  <div class="flex items-center justify-between">
    <div class="text-center flex-1 space-y-1">
      <h2 class="text-2xl font-semibold text-ink">{{ (mode() === 'signup' ? 'auth.signUp' : 'auth.signIn') | translate }}</h2>
    </div>
    <app-language-switcher />
  </div>

  <div class="flex justify-center">
    <button class="text-xs text-brand font-semibold underline" (click)="toggleMode()">
      {{ (mode() === 'signup' ? 'auth.signInPrompt' : 'auth.signUpPrompt') | translate }}
    </button>
  </div>

  <form class="space-y-3" (ngSubmit)="submit()" [formGroup]="onboardingForm">
    <div class="error-banner" *ngIf="errorMessage()">
      {{ errorMessage() }}
    </div>
    <label class="field" *ngIf="mode() === 'signup'">
      <span>{{ 'auth.displayName' | translate }}</span>
      <input formControlName="displayName" type="text" class="input" placeholder="Mama Asha" autocomplete="name">
    </label>

    <label class="field">
      <span>{{ 'auth.email' | translate }}</span>
      <input formControlName="email" type="email" class="input" placeholder="you@email.com" autocomplete="email">
    </label>

    <label class="field">
      <span>{{ 'auth.password' | translate }}</span>
      <input formControlName="password" type="password" class="input" [attr.autocomplete]="mode() === 'signup' ? 'new-password' : 'current-password'">
      </label>

    <div class="grid grid-cols-2 gap-3">
      <label class="field">
        <span>{{ 'auth.language' | translate }}</span>
        <select formControlName="language" class="input">
          <option value="en">{{ 'languages.en' | translate }}</option>
          <option value="sw">{{ 'languages.sw' | translate }}</option>
        </select>
      </label>
      <label class="field" *ngIf="mode() === 'signup'">
        <span>{{ 'auth.phone' | translate }}</span>
        <input formControlName="phone" type="tel" class="input" placeholder="+255...">
      </label>
    </div>

    <label class="field" *ngIf="mode() === 'signup'">
      <span>{{ 'auth.yearOfBirth' | translate }}</span>
        <input formControlName="yearOfBirth" type="number" min="1930" max="2020" class="input">
      </label>

    <div class="rounded-2xl border border-border/70 p-3 space-y-2 text-sm" *ngIf="mode() === 'signup'" formGroupName="conditions">
      <div class="flex items-center justify-between text-xs uppercase tracking-wide">
        <span class="text-muted">{{ 'auth.conditions' | translate }}</span>
        <span class="text-brand font-semibold">{{ 'common.code' | translate }}: {{ onboardingForm.get('shareCode')?.value || '••••••' }}</span>
      </div>
      <div class="flex gap-4">
        <label class="chip">
          <input type="checkbox" formControlName="hypertension" class="checkbox">
          BP
        </label>
        <label class="chip">
          <input type="checkbox" formControlName="diabetes" class="checkbox">
          Sugar
        </label>
      </div>
    </div>

    <div class="space-y-2 pt-2">
      <button type="submit" class="pill-button w-full text-lg">
        {{ (mode() === 'signup' ? 'auth.createAccount' : 'common.continue') | translate }}
      </button>
      <button type="button" class="pill-button pill-button--accent w-full text-lg" (click)="continueWithGoogle()">
        {{ 'auth.continueWithGoogle' | translate }}
      </button>
    </div>
  </form>
</section>
